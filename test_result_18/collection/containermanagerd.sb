(version 1)
(allow default)
(deny file-issue-extension
	(require-all
		(extension-class "com.apple.sandbox.system-group")
		(require-not (literal "/private/var/containers/Shared/SystemGroup/")))
	(require-all
		(extension-class "com.apple.sandbox.system-container")
		(require-not (literal "/private/var/containers/Data/System/")))
	(require-all
		(extension-class "com.apple.sandbox.application-group")
		(require-not (subpath-prefix "${ANY_USER_HOME}/Containers/Shared/AppGroup")))
	(require-all
		(subpath-prefix "${HOME}/Library/Caches/com.apple.containermanagerd")
		(require-not (extension-class "com.apple.app-sandbox.read-write"))
		(require-not (extension-class "com.apple.app-sandbox.read"))
		(require-not (extension-class "com.apple.mediaserverd.read-write"))
		(require-not (extension-class "com.apple.aned.read-only"))
		(require-not (extension-class "com.apple.mediaserverd.read")))
	(require-all
		(extension-class "com.apple.app-sandbox.read-write")
		(require-not (literal))
		(literal "/private/var/")
		(require-not (regex #"^/private/var/mobile/Containers/Data/Application/" #"^/private/var/mobile/Containers/Temp/Data/Application/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/Application/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/Application/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/Application/"))
		(require-not (regex #"^/private/var/mobile/Containers/Data/InternalDaemon/" #"^/private/var/mobile/Containers/Temp/Data/InternalDaemon/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/InternalDaemon/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/InternalDaemon/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/InternalDaemon/"))
		(require-not (regex #"^/private/var/mobile/Containers/Data/PluginKitPlugin/" #"^/private/var/mobile/Containers/Temp/Data/PluginKitPlugin/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/PluginKitPlugin/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/PluginKitPlugin/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/PluginKitPlugin/")))
	(require-all
		(extension-class "com.apple.app-sandbox.read")
		(require-not (literal))
		(literal "/private/var/")
		(require-not (regex #"^/private/var/mobile/Containers/Data/Application/" #"^/private/var/mobile/Containers/Temp/Data/Application/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/Application/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/Application/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/Application/"))
		(require-not (regex #"^/private/var/mobile/Containers/Data/InternalDaemon/" #"^/private/var/mobile/Containers/Temp/Data/InternalDaemon/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/InternalDaemon/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/InternalDaemon/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/InternalDaemon/"))
		(require-not (regex #"^/private/var/mobile/Containers/Data/PluginKitPlugin/" #"^/private/var/mobile/Containers/Temp/Data/PluginKitPlugin/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/PluginKitPlugin/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/PluginKitPlugin/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/PluginKitPlugin/")))
	(require-all
		(extension-class "com.apple.sandbox.container")
		(require-not (literal))
		(literal "/private/var/")
		(require-not (regex #"^/private/var/mobile/Containers/Data/Application/" #"^/private/var/mobile/Containers/Temp/Data/Application/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/Application/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/Application/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/Application/"))
		(require-not (regex #"^/private/var/mobile/Containers/Data/InternalDaemon/" #"^/private/var/mobile/Containers/Temp/Data/InternalDaemon/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/InternalDaemon/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/InternalDaemon/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/InternalDaemon/"))
		(require-not (regex #"^/private/var/mobile/Containers/Data/PluginKitPlugin/" #"^/private/var/mobile/Containers/Temp/Data/PluginKitPlugin/" #"^/private/var/euser[0-9]+/Containers/(Temp/)?Data/PluginKitPlugin/" #"^/private/var/[-0-9A-F]+/Containers/(Temp/)?Data/PluginKitPlugin/" #"^/private/var/Users/[^/]+/Containers/(Temp/)?Data/PluginKitPlugin/"))))
(deny file-read*
	(require-all
		(vnode-type REGULAR-FILE)
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.containermanagerd")))
	(require-all
		(vnode-type DIRECTORY)
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.containermanagerd")))
	(require-all
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.containermanagerd"))
		(require-all (require-not (subpath "/private/var/networkd/Containers"))
(require-not (subpath "/private/var/installd/Library/Caches"))
(require-not (subpath "/private/var/root/Library/Backup/SystemContainers"))
(require-not (literal "/private/var/root/Library/MobileContainerManager."))
(require-not (subpath "/private/var/root/Library/MobileContainerManager"))
(require-not (subpath "/private/var/root/Library/Logs/MobileContainerManager"))
(require-not (literal "/private/var/root/Library/Preferences/com.apple.containermanagerd.plist"))
(require-not (literal "/private/var/root/Library/PersonaVolumes"))
(require-not (regex #"/private/var/root/Library/PersonaVolumes/[UNSUPPORTED]"))
(require-not (literal "/private/var/root/Library/"))
(require-not (literal-prefix "${ANY_USER_HOME}/Library/MobileContainerManager."))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/MobileContainerManager"))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/Backup/SystemContainers"))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/Logs/MobileContainerManager"))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/Caches/com.apple.containermanagerd")))
		(require-any
			(require-all
				(vnode-type DIRECTORY)
				(require-all (require-not (literal "/private/var/installd/Library"))
(require-not (literal "/private/var/installd/Library/Logs"))
(require-not (literal-prefix "${ANY_USER_HOME}/Library"))
(require-not (literal-prefix "${ANY_USER_HOME}/Library/Logs"))))
			(require-all
				(require-not (subpath-prefix "${ANY_USER_HOME}/Containers"))
				(require-not (subpath "/private/var/tmp"))
				(require-not (subpath "/private/var/containers"))
				(require-not (subpath-prefix "${PROCESS_TEMP_DIR}"))))))
(deny file-read-metadata
	(require-all
		(require-all (require-not (literal "/private/var/root/Library"))
(require-not (literal "/private/var/root/Library/Logs")))
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.containermanagerd"))
		(require-not (literal-prefix "${HOME}/Library/Caches"))
		(require-not (literal "/private/var/root/Library/Caches"))))
(deny file-write*
	(require-all
		(vnode-type REGULAR-FILE)
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.containermanagerd")))
	(require-all
		(vnode-type DIRECTORY)
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.containermanagerd")))
	(require-all
		(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.containermanagerd"))
		(require-all (require-not (subpath "/private/var/networkd/Containers"))
(require-not (subpath "/private/var/installd/Library/Caches"))
(require-not (subpath "/private/var/root/Library/Backup/SystemContainers"))
(require-not (literal "/private/var/root/Library/MobileContainerManager."))
(require-not (subpath "/private/var/root/Library/MobileContainerManager"))
(require-not (subpath "/private/var/root/Library/Logs/MobileContainerManager"))
(require-not (literal "/private/var/root/Library/Preferences/com.apple.containermanagerd.plist"))
(require-not (literal "/private/var/root/Library/PersonaVolumes"))
(require-not (regex #"/private/var/root/Library/PersonaVolumes/[UNSUPPORTED]"))
(require-not (literal "/private/var/root/Library/"))
(require-not (literal-prefix "${ANY_USER_HOME}/Library/MobileContainerManager."))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/MobileContainerManager"))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/Backup/SystemContainers"))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/Logs/MobileContainerManager"))
(require-not (subpath-prefix "${ANY_USER_HOME}/Library/Caches/com.apple.containermanagerd")))
		(require-any
			(require-all
				(vnode-type DIRECTORY)
				(require-all (require-not (literal "/private/var/installd/Library"))
(require-not (literal "/private/var/installd/Library/Logs"))
(require-not (literal-prefix "${ANY_USER_HOME}/Library"))
(require-not (literal-prefix "${ANY_USER_HOME}/Library/Logs"))))
			(require-all
				(require-not (subpath-prefix "${ANY_USER_HOME}/Containers"))
				(require-not (subpath "/private/var/tmp"))
				(require-not (subpath "/private/var/containers"))
				(subpath-prefix "${PROCESS_TEMP_DIR}")))))
(deny file-write-create
	(require-all
		(vnode-type DIRECTORY)
		(require-all (require-not (literal "/private/var/root/Library"))
(require-not (literal "/private/var/root/Library/Logs")))
		(require-not (literal "/private/var/root/Library/Caches"))
		(require-not (literal-prefix "${HOME}/Library/Caches"))
		(subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.containermanagerd")
		(subpath-prefix "${HOME}/Library/Caches/com.apple.containermanagerd")
		(require-any (subpath "/private/var/networkd/Containers")
(subpath "/private/var/installd/Library/Caches")
(subpath "/private/var/root/Library/Backup/SystemContainers")
(literal "/private/var/root/Library/MobileContainerManager.")
(subpath "/private/var/root/Library/MobileContainerManager")
(subpath "/private/var/root/Library/Logs/MobileContainerManager")
(literal "/private/var/root/Library/Preferences/com.apple.containermanagerd.plist")
(literal "/private/var/root/Library/PersonaVolumes")
(regex #"/private/var/root/Library/PersonaVolumes/[UNSUPPORTED]")
(literal "/private/var/root/Library/")
(literal-prefix "${ANY_USER_HOME}/Library/MobileContainerManager.")
(subpath-prefix "${ANY_USER_HOME}/Library/MobileContainerManager")
(subpath-prefix "${ANY_USER_HOME}/Library/Backup/SystemContainers")
(subpath-prefix "${ANY_USER_HOME}/Library/Logs/MobileContainerManager")
(subpath-prefix "${ANY_USER_HOME}/Library/Caches/com.apple.containermanagerd"))
		(require-any
			(require-all
				(vnode-type DIRECTORY)
				(require-any (literal "/private/var/installd/Library")
(literal "/private/var/installd/Library/Logs")
(literal-prefix "${ANY_USER_HOME}/Library")
(literal-prefix "${ANY_USER_HOME}/Library/Logs")))
			(require-all
				(subpath-prefix "${ANY_USER_HOME}/Containers")
				(subpath "/private/var/tmp")
				(subpath "/private/var/containers")
				(subpath-prefix "${PROCESS_TEMP_DIR}")))))
(deny file-write-owner
	(require-all
		(require-all (require-not (literal "/private/var/root/Library"))
(require-not (literal "/private/var/root/Library/Logs")))
		(require-not (literal "/private/var/root/Library/Caches"))))
(deny file-write-setugid)
(deny file-write-unlink
	(entitlement-is-present com.apple.private.oop-jit.loader)
	(require-all
		(extension com.apple.sandbox.oopjit)
		(require-not (subpath "/private/var/OOPJit"))))
(deny ipc-posix-sem*
	(ipc-posix-name "containermanagerd."))
(deny job-creation)
(deny mach-lookup
	(require-all
		(require-not (global-name "com.apple.mobile.keybagd.UserManager.xpc"))
		(require-not (global-name "com.apple.mobile.keybagd.xpc"))
		(require-not (global-name "com.apple.mobile.usermanagerd.xpc"))
		(require-not (global-name "com.apple.frontboard.systemappservices"))
		(require-not (extension com.apple.security.exception.mach-lookup.global-name))
		(require-not (extension com.apple.security.exception.mach-lookup.local-name))
		(require-any
			(require-any (global-name "com.apple.cfprefsd.daemon")
(global-name "com.apple.cfprefsd.daemon.system"))
			(require-all
				(global-name "com.apple.system.notification_center")
				(entitlement-is-bool-true com.apple.security.on-demand-install-capable)
				(require-any
					(xpc-service-name-regex #".+")
					(xpc-service-name "com.apple.WebKit.")
					(xpc-service-name "com.apple.CoreGraphics.CGPDFService")))
			(require-all
				(global-name "com.apple.lsd.openurl")
				(global-name "com.apple.tccd")
				(global-name "com.apple.lsd.advertisingidentifiers")
				(xpc-service-name-regex #".+")))))
(deny sysctl*
	(require-all
		(sysctl-name "kern.crash_behavior_test_mode")
		(debug-mode)))
(deny sysctl-read
	(sysctl-name "kern.bootsessionuuid")
	(require-all
		(sysctl-name "kern.crash_behavior_test_mode")
		(debug-mode)))
(deny system-fsctl
	(require-all
		(require-not (fsctl-command-regex [UNSUPPORTED](_IO "J" 2)))
		(require-not (fsctl-command-regex [UNSUPPORTED](_IO "J" 32)))
		(require-not (fsctl-command-regex [UNSUPPORTED](_IO "J" 113)))
		(fsctl-command-regex [UNSUPPORTED](_IO "J" 68))))
(deny system-kas-info)
(deny storage-class-map)
