(version 1)
(allow default)
(deny file-ioctl
	(require-all
		(require-not (literal "/dev/aes_0"))
		(require-not (literal "/dev/bpf"))
		(literal "/dev/dtracehelper")))
(deny file-issue-extension
	(require-all
		(require-any (subpath "/private/preboot/Cryptexes")
(subpath "/System/Cryptexes"))
		(extension-class "com.apple.app-sandbox.read")))
(deny file-map-executable
	(subpath "/usr/appleinternal/lib/sanitizers")
	(require-all (require-not (subpath "/private/preboot/Cryptexes"))
(require-not (subpath "/System/Cryptexes"))))
(deny file-read*
	(require-all
		(require-not (literal "/Library/Preferences/com.apple.networkextension.uuidcache.plist"))
		(require-not (literal))
		(require-any
			(require-all
				(subpath "/usr/appleinternal/lib/sanitizers")
				(require-all (require-not (regex #"/private/var/folders/[UNSUPPORTED]+/[UNSUPPORTED]+/C/mds/?"))
(require-not (regex #"/private/var/folders/[UNSUPPORTED]+/[UNSUPPORTED]+/-Caches-/mds/?")))
				(require-not (literal "/dev/zero"))
				(require-not (literal "/private/var/db/DarwinDirectory/local/recordStore.data"))
				(require-not (literal "/private/var/run/mDNSResponder"))
				(require-not (literal "/dev/random"))
				(require-any
					(require-all
						(file-mode #o0004)
						(require-not (subpath "/usr/lib"))
						(require-not (subpath "/usr/share"))
						(require-not (subpath "/System")))
					(require-all
						(literal "/private/var/db/mds/")
						(require-not (regex #"^/private/var/db/mds/[0-9]+/" #"^/private/var/db/mds/[0-9]+$"))
						(require-any
							(extension com.apple.app-sandbox.read)
							(extension com.apple.app-sandbox.read-write)
							(extension com.apple.security.exception.files.absolute-path.read-only)
							(extension com.apple.security.exception.files.absolute-path.read-write)
							(require-any (subpath "/private/var/hardware/FactoryData")
(literal "/usr/standalone/firmware/apticket.der"))
							(require-any (literal "/System/Library/Caches/apticket.der")
(subpath "/System/Library/Caches/com.apple.factorydata")
(subpath "/System/Library/Caches/com.apple.kernelcaches"))))))
			(require-all
				(require-not (literal "/private/var/preferences/com.apple.networkd.plist"))
				(require-not (literal "/Library/Preferences/com.apple.networkd.plist"))
				(require-not (subpath "/private/var/log/mDNSResponder"))
				(require-not (literal "/private/var/db/com.apple.networkextension.tracker-info"))
				(require-any
					(require-all
						(literal "/private/var/tmp/mds/")
						(require-not (regex #"^/private/var/tmp/mds/[0-9]+/" #"^/private/var/tmp/mds/[0-9]+$")))
					(require-all
						(require-not (literal "/dev/null"))
						(require-not (literal "/private"))
						(require-not (literal "/dev/aes_0"))
						(require-all (require-not (literal "/private/preboot/cryptex1/current/SystemVersion.plist"))
(require-not (literal "/private/preboot/cryptex1/current/RestoreVersion.plist")))
						(require-not (literal "/dev/urandom"))
						(require-not (literal "/private/var/tmp/mDNSResponder"))
						(require-not (literal "/dev/dtracehelper"))
						(require-all (require-not (subpath "/private/preboot/Cryptexes"))
(require-not (subpath "/System/Cryptexes")))
						(require-all (require-not (literal "/System"))
(require-not (literal "/private/preboot")))
						(require-not (literal "/"))))))))
(deny file-read-data
	(require-all
		(require-all (require-not (subpath "/private/var/tmp/mds"))
(require-not (literal "/private/var/db/crls/crlcache.db"))
(require-not (literal "/Library/Keychains/System.keychain")))
		(require-not (subpath "/private/var/db/mds"))
		(require-any
			(literal "/Library/Keychains/")
			(require-all
				(require-not (literal "/private/var/preferences/com.apple.networkd.plist"))
				(require-all (require-not (literal "/usr/sbin/mDNSResponder"))
(require-not (subpath "/AppleInternal/Library/Preferences/Logging"))
(require-not (literal "/private/etc"))
(require-not (literal "/private/var/mobile/Library/com.apple.DeviceAccess/DANetworkUUIDs.plist"))
(require-not (literal "/Library/Security/Trust Settings/Admin.plist"))
(require-not (literal "/Library/Preferences/.GlobalPreferences."))
(require-not (subpath "/Library/Preferences/Logging"))
(require-not (literal "/Library/Preferences/ByHost/.GlobalPreferences."))
(require-not (literal "/Library/Preferences/com.apple.security."))
(require-not (literal "/Library/Preferences/com.apple.crypto.plist"))
(require-not (literal "/Library/Preferences/com.apple.mDNSResponder.plist"))
(require-not (literal "/Library/Preferences/SystemConfiguration/preferences.plist"))
(require-not (literal "/Library/Preferences/SystemConfiguration/com.apple.nat.plist"))
(require-not (literal "/Library/Preferences/SystemConfiguration/com.apple.PowerManagement.plist")))
				(require-not (literal "/dev/console"))
				(require-not (literal "/usr/sbin"))
				(require-not (subpath "/private/var/preferences/Logging"))
				(require-not (literal "/private/etc/hosts"))
				(require-not (subpath "/System/Library/Preferences/Logging"))
				(require-not (literal "/private/var/preferences/SystemConfiguration/preferences.plist"))
				(require-not (subpath "/private/var/db/timezone"))))))
(deny file-write*
	(require-all
		(require-not (literal "/private/var/tmp/mDNSResponder"))
		(require-not (subpath "/private/var/log/mDNSResponder"))
		(require-all (require-not (regex #"/private/var/folders/[UNSUPPORTED]+/[UNSUPPORTED]+/C/mds/?"))
(require-not (regex #"/private/var/folders/[UNSUPPORTED]+/[UNSUPPORTED]+/-Caches-/mds/?")))
		(require-not (literal "/private/var/run/mDNSResponder"))
		(require-any
			(require-all
				(literal "/private/var/db/mds/")
				(require-not (regex #"^/private/var/db/mds/[0-9]+/" #"^/private/var/db/mds/[0-9]+$")))
			(require-all
				(file-mode #o0000)
				(literal "/private/var/tmp/mds/")
				(regex #"^/private/var/tmp/mds/[0-9]+/" #"^/private/var/tmp/mds/[0-9]+$"))
			(require-all
				(require-not (literal "/cores/"))
				(literal "/private/var/tmp/mds/")
				(regex #"^/private/var/tmp/mds/[0-9]+/" #"^/private/var/tmp/mds/[0-9]+$")))))
(deny file-write-data
	(require-all
		(require-not (literal "/dev/null"))
		(require-not (literal "/dev/aes_0"))
		(require-not (literal "/dev/dtracehelper"))
		(require-not (literal "/dev/zero"))
		(require-not (literal "/dev/console"))))
(deny file-write-setugid)
(deny file-write-unlink
	(entitlement-is-present com.apple.private.oop-jit.loader)
	(require-all
		(extension com.apple.sandbox.oopjit)
		(require-not (subpath "/private/var/OOPJit"))))
(deny iokit-open-user-client
	(require-all
		(require-all (require-not (iokit-user-client-class "mDNSOffloadUserClient"))
(require-not (iokit-user-client-class "wlDNSOffloadUserClient"))
(require-not (iokit-user-client-class "NVEthernetUserClientMDNS")))
		(require-not (iokit-user-client-class "IO80211APIUserClient"))
		(require-not (iokit-user-client-class "AppleMobileFileIntegrityUserClient"))
		(require-not (iokit-user-client-class "RootDomainUserClient"))))
(deny job-creation)
(deny mach-lookup
	(require-all
		(require-not (global-name "com.apple.securityd"))
		(require-not (global-name "com.apple.SystemConfiguration.DNSConfiguration"))
		(require-not (global-name "com.apple.SystemConfiguration.NetworkInformation"))
		(require-not (global-name "com.apple.server.bluetooth.le.att.xpc"))
		(require-not (global-name "com.apple.powerlog.plxpclogger.xpc"))
		(require-all (require-not (global-name "com.apple.awacs"))
(require-not (global-name "com.apple.webcontentfilter.dns"))
(require-not (global-name "com.apple.mDNSResponder_Helper"))
(require-not (global-name "com.apple.distributed_notifications.2"))
(require-not (global-name "com.apple.server.bluetooth.general.xpc"))
(require-not (global-name "com.apple.bluetoothd"))
(require-not (global-name "com.apple.bsd.dirhelper")))
		(require-not (global-name "com.apple.SystemConfiguration.helper"))
		(require-not (extension com.apple.security.exception.mach-lookup.local-name))
		(require-not (global-name "com.apple.system.notification_center"))
		(require-not (extension com.apple.security.exception.mach-lookup.global-name))
		(require-not (global-name "com.apple.CoreServices.coreservicesd"))
		(require-not (global-name "com.apple.wifip2pd"))
		(require-not (global-name "com.apple.DeviceAccess.xpc"))
		(require-not (global-name "com.apple.SystemConfiguration.configd"))
		(require-not (global-name "com.apple.wifi.manager"))
		(require-not (global-name "com.apple.cfnetwork.cfnetworkagent"))
		(require-not (global-name "com.apple.StatusKit.presence"))
		(require-not (global-name "com.apple.nehelper"))
		(require-not (global-name "com.apple.nesessionmanager"))
		(require-not (global-name "com.apple.system.logger"))
		(require-not (global-name "com.apple.dnssd.service"))
		(require-not (global-name "com.apple.coreservices.quarantine-resolver"))
		(require-not (global-name "com.apple.ocspd"))
		(require-not (global-name "com.apple.usymptomsd"))
		(require-not (global-name "com.apple.trustd"))
		(require-not (global-name "com.apple.analyticsd"))
		(require-not (global-name "com.apple.server.bluetooth"))
		(require-not (global-name "com.apple.nesessionmanager.content-filter"))
		(require-not (global-name "com.apple.awdd"))
		(require-not (global-name "com.apple.SecurityServer"))
		(require-not (global-name "com.apple.mDNSResponderHelper"))
		(require-not (global-name "com.apple.mobilegestalt.xpc"))
		(require-not (global-name "com.apple.PowerManagement.control"))
		(require-not (global-name "com.apple.lsd.mapdb"))
		(require-not (global-name "com.apple.distributed_notifications@1v3"))
		(require-not (global-name "com.apple.networkd_privileged"))
		(require-not (global-name "com.apple.cfnetwork.AuthBrokerAgent"))
		(require-not (global-name "com.apple.SystemConfiguration.SCNetworkReachability"))
		(require-any
			(xpc-service-name "com.apple.WebKit.")
			(require-all
				(require-not (global-name "com.apple.diagnosticd"))
				(require-not (global-name "com.apple.system.DirectoryService.libinfo_v1"))
				(require-all (require-not (global-name "com.apple.cfprefsd.daemon"))
(require-not (global-name "com.apple.cfprefsd.daemon.system")))
				(require-not (global-name "com.apple.cfprefsd.agent"))
				(require-not (global-name "com.apple.logd"))
				(require-not (xpc-service-name-regex #".+"))
				(require-not (local-name "com.apple.cfprefsd.agent"))
				(global-name "com.apple.lsd.openurl")
				(global-name "com.apple.tccd")
				(global-name "com.apple.lsd.advertisingidentifiers")))))
(deny mach-register
	(require-not (global-name "com.apple.d2d.ipc")))
(deny sysctl*
	(sysctl-name "net.inet.tcp.info"))
(deny system-kas-info)
(deny user-preference-read
	(preference-domain "com.apple.mDNSResponder"))
(deny storage-class-map)
