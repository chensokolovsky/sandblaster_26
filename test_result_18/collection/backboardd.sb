(version 1)
(allow default)
(deny file-issue-extension
	(require-all
		(extension com.apple.sandbox.application-group)
		(require-any
			(regex #"/private/var/PersonaVolumes/[UNSUPPORTED]+/Containers/Shared/AppGroup/[UNSUPPORTED]+/.com.apple.")
			(require-all
				(literal "/private/var/")
				(regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]")
				(subpath-prefix "${FRONT_USER_HOME}"))
			(require-all
				(regex #"/private/var/PersonaVolumes/[UNSUPPORTED]+/Containers/Shared/AppGroup/[UNSUPPORTED]+/")
				(require-not (extension-class "com.apple.quicklook.readonly"))
				(require-not (extension-class "com.apple.app-sandbox.read-write"))
				(require-not (extension-class "com.apple.app-sandbox.read"))
				(require-not (extension-class "com.apple.sharing.airdrop.readonly"))
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.nsurlsessiond.readonly"))
				(require-not (extension-class "com.apple.wcd.readonly"))
				(require-not (extension-class "com.apple.aned.read-only"))
				(require-not (extension-class "com.apple.mediaserverd.read"))
				(extension-class "com.apple.spotlight-indexable"))
			(require-all
				(literal "/private/var/")
				(regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/")
				(subpath-prefix "${FRONT_USER_HOME}")
				(require-not (extension-class "com.apple.quicklook.readonly"))
				(require-not (extension-class "com.apple.app-sandbox.read-write"))
				(require-not (extension-class "com.apple.app-sandbox.read"))
				(require-not (extension-class "com.apple.sharing.airdrop.readonly"))
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.nsurlsessiond.readonly"))
				(require-not (extension-class "com.apple.wcd.readonly"))
				(require-not (extension-class "com.apple.aned.read-only"))
				(require-not (extension-class "com.apple.mediaserverd.read"))
				(extension-class "com.apple.spotlight-indexable"))
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(require-any
					(require-all
						(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
						(require-any
							(require-all
								(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")
								(require-not (extension-class "com.apple.mediaserverd.read-write"))
								(require-not (extension-class "com.apple.mediaserverd.read")))
							(require-all
								(extension-class "com.apple.app-sandbox.read-write")
								(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
							(require-all
								(extension-class "com.apple.app-sandbox.read")
								(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
							(require-all
								(extension-class "com.apple.mediaserverd.read-write")
								(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
							(require-all
								(extension-class "com.apple.aned.read-only")
								(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
							(require-all
								(extension-class "com.apple.mediaserverd.read")
								(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))))
					(require-all
						(literal "/private/var/")
						(require-any
							(require-all
								(subpath-prefix "${FRONT_USER_HOME}")
								(require-not (regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+$")))
							(require-all
								(subpath-prefix "${FRONT_USER_HOME}")
								(require-not (regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+$")))
							(require-all
								(literal "/private/var/PersonaVolumes/")
								(require-not (regex #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+$")))
							(require-all
								(literal "/private/var/PersonaVolumes/")
								(require-not (regex #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+$")))))))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(literal "/private/var/")
				(require-any
					(require-all
						(subpath-prefix "${FRONT_USER_HOME}")
						(require-not (regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+$")))
					(require-all
						(literal "/private/var/PersonaVolumes/")
						(require-not (regex #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+$")))))
			(require-all
				(extension-class "com.apple.aned.read-only")
				(literal "/private/var/")
				(require-any
					(require-all
						(subpath-prefix "${FRONT_USER_HOME}")
						(require-not (regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+$" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+$")))
					(require-all
						(literal "/private/var/PersonaVolumes/")
						(require-not (regex #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+$")))))))
	(require-all
		(extension-class "com.apple.aned.read-only")
		(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
		(require-any
			(require-all
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.mediaserverd.read")))
			(require-all
				(extension-class "com.apple.app-sandbox.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.aned.read-only")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))))
	(require-all
		(extension-class "com.apple.app-sandbox.read-write")
		(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
		(require-any
			(require-all
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.mediaserverd.read")))
			(require-all
				(extension-class "com.apple.app-sandbox.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.aned.read-only")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))))
	(require-all
		(extension-class "com.apple.app-sandbox.read")
		(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
		(require-any
			(require-all
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.mediaserverd.read")))
			(require-all
				(extension-class "com.apple.app-sandbox.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.aned.read-only")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))))
	(require-all
		(extension-class "com.apple.mediaserverd.read-write")
		(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
		(require-any
			(require-all
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.mediaserverd.read")))
			(require-all
				(extension-class "com.apple.app-sandbox.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.aned.read-only")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))))
	(require-all
		(extension-class "com.apple.mediaserverd.read")
		(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
		(require-any
			(require-all
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")
				(require-not (extension-class "com.apple.mediaserverd.read-write"))
				(require-not (extension-class "com.apple.mediaserverd.read")))
			(require-all
				(extension-class "com.apple.app-sandbox.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read-write")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.aned.read-only")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")))))
(deny file-read*
	(require-all
		(require-not (literal-prefix "${FRONT_USER_HOME}/Library/Preferences/com.apple.carrier.plist"))
		(require-all (require-not (subpath "/private/var/logs/hidfw-crashlogs"))
(require-not (subpath-prefix "${HOME}/Library/CoreBrightness"))
(require-not (literal-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
(require-not (subpath-prefix "${HOME}/Library/Accessibility"))
(require-not (subpath-prefix "${HOME}/Library/Application Support/Multitouch"))
(require-not (subpath-prefix "${HOME}/Library/Logs/Multitouch"))
(require-not (subpath-prefix "${HOME}/Library/Logs/ECGSensor"))
(require-not (subpath-prefix "${HOME}/Library/Logs/PPGSensor"))
(require-not (subpath-prefix "${HOME}/Library/Logs/HIDPreprocessedAccel"))
(require-not (subpath-prefix "${HOME}/Library/Logs/CrashReporter/harmony"))
(require-not (subpath-prefix "${HOME}/Library/Logs/CrashReporter/CoreAnimation")))
		(extension com.apple.sandbox.application-group)
		(require-not (subpath-prefix "${FRONT_USER_HOME}/Library/Carrier Bundles/Overlay"))
		(require-any
			(require-all
				(regex #"/private/var/PersonaVolumes/[UNSUPPORTED]+/Containers/Shared/AppGroup/[UNSUPPORTED]+/.com.apple.")
				(require-any
					(require-not (literal "/System/Library/Carrier Bundles/"))
					(require-all
						(literal "/private/var/")
						(subpath-prefix "${FRONT_USER_HOME}")
						(require-not (regex #"^/private/var/mobile/Library/Carrier Bundles//carrier[.]plist$" #"^/private/var/mobile/Library/Carrier Bundles/.+/carrier[.]plist$" #"^/private/var/euser[0-9]+/Library/Carrier Bundles/.*/carrier[.]plist$" #"^/private/var/[-0-9A-F]+/Library/Carrier Bundles/.*/carrier[.]plist$" #"^/private/var/Users/[^/]+/Library/Carrier Bundles/.*/carrier[.]plist$"))
						(require-not (regex #"^/private/var/mobile/Library/Carrier Bundles/[.]png$" #"^/private/var/mobile/Library/Carrier Bundles/.+[.]png$" #"^/private/var/euser[0-9]+/Library/Carrier Bundles/.*[.]png$" #"^/private/var/[-0-9A-F]+/Library/Carrier Bundles/.*[.]png$" #"^/private/var/Users/[^/]+/Library/Carrier Bundles/.*[.]png$")))
					(require-all
						(regex #"^/System/Library/Carrier Bundles//carrier[.]plist$" #"^/System/Library/Carrier Bundles/.+/carrier[.]plist$")
						(regex #"^/System/Library/Carrier Bundles/[.]png$" #"^/System/Library/Carrier Bundles/.+[.]png$"))))
			(require-all
				(literal "/private/var/")
				(regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]")
				(subpath-prefix "${FRONT_USER_HOME}")
				(require-not (regex #"^/private/var/mobile/Library/Carrier Bundles//carrier[.]plist$" #"^/private/var/mobile/Library/Carrier Bundles/.+/carrier[.]plist$" #"^/private/var/euser[0-9]+/Library/Carrier Bundles/.*/carrier[.]plist$" #"^/private/var/[-0-9A-F]+/Library/Carrier Bundles/.*/carrier[.]plist$" #"^/private/var/Users/[^/]+/Library/Carrier Bundles/.*/carrier[.]plist$"))
				(require-not (regex #"^/private/var/mobile/Library/Carrier Bundles/[.]png$" #"^/private/var/mobile/Library/Carrier Bundles/.+[.]png$" #"^/private/var/euser[0-9]+/Library/Carrier Bundles/.*[.]png$" #"^/private/var/[-0-9A-F]+/Library/Carrier Bundles/.*[.]png$" #"^/private/var/Users/[^/]+/Library/Carrier Bundles/.*[.]png$"))))))
(deny file-write*
	(require-all
		(require-all (require-not (subpath "/private/var/logs/hidfw-crashlogs"))
(require-not (subpath-prefix "${HOME}/Library/CoreBrightness"))
(require-not (literal-prefix "${HOME}/Library/Caches/com.apple.backboardd"))
(require-not (subpath-prefix "${HOME}/Library/Accessibility"))
(require-not (subpath-prefix "${HOME}/Library/Application Support/Multitouch"))
(require-not (subpath-prefix "${HOME}/Library/Logs/Multitouch"))
(require-not (subpath-prefix "${HOME}/Library/Logs/ECGSensor"))
(require-not (subpath-prefix "${HOME}/Library/Logs/PPGSensor"))
(require-not (subpath-prefix "${HOME}/Library/Logs/HIDPreprocessedAccel"))
(require-not (subpath-prefix "${HOME}/Library/Logs/CrashReporter/harmony"))
(require-not (subpath-prefix "${HOME}/Library/Logs/CrashReporter/CoreAnimation")))
		(require-any
			(require-all
				(extension com.apple.sandbox.application-group)
				(require-any
					(regex #"/private/var/PersonaVolumes/[UNSUPPORTED]+/Containers/Shared/AppGroup/[UNSUPPORTED]+/.com.apple.")
					(require-all
						(literal "/private/var/")
						(regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/[.]com[.]apple[.]")
						(subpath-prefix "${FRONT_USER_HOME}"))
					(require-all
						(require-not (regex #"/private/var/PersonaVolumes/[UNSUPPORTED]+/Containers/Shared/AppGroup/[UNSUPPORTED]+/"))
						(literal "/private/var/")
						(regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/")
						(require-not (subpath-prefix "${FRONT_USER_HOME}")))))
			(require-all
				(vnode-type REGULAR-FILE)
				(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.backboardd")))
			(require-all
				(vnode-type DIRECTORY)
				(require-not (subpath-prefix "${HOME}/Library/Caches/com.apple.nsurlsessiond/Downloads/com.apple.backboardd")))
			(require-all
				(require-all (require-not (subpath "/private/var/tmp/com.apple.backboardd"))
(require-not (subpath-prefix "${PROCESS_TEMP_DIR}/com.apple.backboardd")))
				(subpath-prefix "${HOME}/Library/Caches/com.apple.backboardd")))))
(deny file-write-create
	(require-all
		(vnode-type DIRECTORY)
		(require-not (literal-prefix "${HOME}/Library/Logs/CrashReporter"))
		(require-not (literal-prefix "${HOME}/Library/Caches")))
	(require-all
		(literal "/private/var/")
		(extension com.apple.sandbox.application-group)
		(require-any
			(require-all
				(literal "/private/var/PersonaVolumes/")
				(regex #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+/Library$" #"^/private/var/PersonaVolumes/[^/]+/Containers/Shared/AppGroup/[^/]+/Library/Preferences$"))
			(require-all
				(subpath-prefix "${FRONT_USER_HOME}")
				(regex #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/Library$" #"^/private/var/mobile/Containers/Shared/AppGroup/[^/]+/Library/Preferences$" #"^/private/var/euser[0-9]+/Containers/Shared/AppGroup/[^/]+/Library(/Preferences)?$" #"^/private/var/[-0-9A-F]+/Containers/Shared/AppGroup/[^/]+/Library(/Preferences)?$" #"^/private/var/Users/[^/]+/Containers/Shared/AppGroup/[^/]+/Library(/Preferences)?$")))))
(deny file-write-setugid)
(deny file-write-unlink
	(entitlement-is-present com.apple.private.oop-jit.loader)
	(require-all
		(extension com.apple.sandbox.oopjit)
		(require-not (subpath "/private/var/OOPJit"))))
(deny iokit-open-user-client
	(require-all
		(require-not (iokit-user-client-class "AppleSPUHIDDeviceUserClient"))
		(require-not (iokit-user-client-class "AppleSPUUserClient"))
		(require-not (iokit-user-client-class "IOGPUDeviceUserClient"))
		(require-all (require-not (iokit-user-client-class "IOAccelDevice2"))
(require-not (iokit-user-client-class "IOAccelContext2"))
(require-not (iokit-user-client-class "IOAccelSharedUserClient2")))
		(require-all (require-not (iokit-user-client-class "IOTimeSyncUserClient"))
(require-not (iokit-user-client-class "IOTimeSyncClockManagerUserClient")))
		(require-all (require-not (iokit-user-client-class "EXDisplayPipeUserClient"))
(require-not (iokit-user-client-class "DCPAVServiceProxyUserClient"))
(require-not (iokit-user-client-class "AFKEndpointInterfaceUserClient"))
(require-not (iokit-user-client-class "ApplePearlUserClient"))
(require-not (iokit-user-client-class "AppleMaggieUserClient"))
(require-not (iokit-user-client-class "AppleMultitouchSPIUserClient"))
(require-not (iokit-user-client-class "AppleMultitouchTimestampSyncUC"))
(require-not (iokit-user-client-class "AppleMultitouchDeviceUserClient"))
(require-not (iokit-user-client-class "AppleSPUHapticsAudioUC"))
(require-not (iokit-user-client-class "AppleSPUProfileDriverUserClient"))
(require-not (iokit-user-client-class "AppleSPUFastpathDriverUserClient"))
(require-not (iokit-user-client-class "AppleActuatorDeviceUserClient"))
(require-not (iokit-user-client-class "AppleAOPAnalyticsUserClient"))
(require-not (iokit-user-client-class "AppleAOPButtonHapticsServiceUserClient"))
(require-not (iokit-user-client-class "AppleHDQGasGaugeControlUserClient"))
(require-not (iokit-user-client-class "AppleHIDTransportDeviceUserClient"))
(require-not (iokit-user-client-class "AppleHIDTransportBootloaderUserClient")))
		(require-not (iokit-user-client-class "IOSurfaceSendRight"))
		(require-not (iokit-user-client-class "AppleSPUHIDDriverUserClient"))
		(require-not (iokit-user-client-class "IOHIDEventServiceUserClient"))
		(require-not (iokit-user-client-class "AppleSMCClient"))
		(require-not (iokit-user-client-class "IOSurfaceAcceleratorClient"))
		(require-not (iokit-user-client-class "AGXCommandQueue"))
		(require-all (require-not (iokit-user-client-class "IOAccelDevice"))
(require-not (iokit-user-client-class "IOAccelContext"))
(require-not (iokit-user-client-class "IOAccelSubmitter2"))
(require-not (iokit-user-client-class "IOAccelSharedUserClient")))
		(require-not (iokit-user-client-class "AGXSharedUserClient"))
		(require-not (iokit-user-client-class "IOReportUserClient"))
		(require-not (iokit-user-client-class "AGXDevice"))
		(require-not (iokit-user-client-class "RootDomainUserClient"))
		(require-not (iokit-user-client-class "IOSurfaceRootUserClient"))
		(require-not (iokit-user-client-class "AppleKeyStoreUserClient"))
		(require-not (iokit-user-client-class "IOHIDLibUserClient"))
		(require-not (iokit-user-client-class "AppleARMIICUserClient"))
		(require-not (iokit-user-client-class "IOHIDResourceDeviceUserClient"))
		(require-not (iokit-user-client-class "IOTimeSyncUserFilteredServiceUserClient"))
		(require-not (iokit-user-client-class "ApplePPMUserClient"))
		(require-not (iokit-user-client-class "IOMobileFramebufferUserClient"))
		(require-all (require-not (iokit-connection "IOGPU"))
(require-not (iokit-connection "IOGraphicsAccelerator2")))
		(require-not (extension com.apple.security.exception.iokit-user-client-class))
		(require-any (iokit-user-client-class "H11ANEInDirectPathClient")
(iokit-user-client-class "AppleVirtIONeuralEngineDeviceUserClient"))
		(iokit-user-client-class "ANEClientHintsUserClient")
		(entitlement-is-bool-true com.apple.private.ane.allow-set-client-hints)))
(deny iokit-set-properties
	(require-all
		(iokit-property "InSession")
		(require-not (iokit-user-client-class "VaxholmDriver")))
	(require-all
		(iokit-property "KeyboardBacklight")
		(require-not (iokit-user-client-class "IOResources")))
	(require-all
		(iokit-user-client-class "IOHIDLibUserClient")
		(require-all (require-not (iokit-property "MaxReportBufferCount"))
(require-not (iokit-property "ReportBufferEntrySize"))))
	(require-all
		(iokit-user-client-class "IOPMrootDomain")
		(require-all (require-not (iokit-property "System Boot Complete"))
(require-not (iokit-property "System Idle Seconds"))
(require-not (iokit-property "System Idle Milliseconds"))))
	(require-all
		(require-not (iokit-user-client-class "IOHIDEventServiceUserClient"))
		(require-any
			(require-all
				(iokit-user-client-class "AppleMultitouchTimestampSyncUC")
				(require-all (require-not (iokit-property "Timestamp Sync Count"))
(require-not (iokit-property "Timestamp Sync Period"))
(require-not (iokit-property "Timestamp Sync Pulse Width"))))
			(require-all
				(require-any (iokit-property "StateConfig")
(iokit-property "GlobalConfig"))
				(require-any (iokit-user-client-class "AppleSPUButtonDriver")
(iokit-user-client-class "AppleSPUHapticsAudioDriver")))
			(require-all
				(iokit-user-client-class "AppleMultitouchDevice")
				(require-all (require-not (iokit-property "MouseUserPreferences"))
(require-not (iokit-property "FirstPowerOffSuppressed"))
(require-not (iokit-property "TrackpadUserPreferences")))
				(require-not (iokit-property "DeviceOpenedByEventSystem")))
			(require-all
				(iokit-property "hid-merge-personality")
				(iokit-user-client-class "AppleHIDTransportBootloaderHBPP"))
			(require-all
				(iokit-user-client-class "AppleEmbeddedBluetoothHaptics")
				(require-all (require-not (iokit-property "HapticsConfig"))
(require-not (iokit-property "HapticsMessage"))))
			(require-all
				(iokit-user-client-class "AppleEmbeddedBluetoothForce")
				(require-all (require-not (iokit-property "FireflyMessage"))
(require-not (iokit-property "ResendDescriptor"))))
			(require-all
				(require-any (iokit-property "BLNitsCap")
(iokit-property "CurrentCode")
(iokit-property "Time")
(iokit-property "TimezeroDelta")
(iokit-property "SaturatePositiveCount")
(iokit-property "IOMFBBrightnessLevel")
(iokit-property "IOMFBContrastEnhancerStrength")
(iokit-property "AOTEnable")
(iokit-property "AmbientBrightness")
(iokit-property "enableSBIM")
(iokit-property "enablePLCMode")
(iokit-property "enableTwilight")
(iokit-property "com.apple.iomfb.underrun")
(iokit-property "com.apple.TritiumVSHCompensation.TimezeroDelta")
(iokit-property "com.apple.TritiumVSHCompensation.CurrentCode")
(iokit-property "com.apple.TritiumVSHCompensation.CumulativeOnTime")
(iokit-property "com.apple.TritiumVSHCompensation.SaturatePositiveCount")
(iokit-property "com.apple.TritiumVSHCompensation.SaturateNegativeCount"))
				(require-not (iokit-user-client-class "IOMobileFramebufferShim"))
				(require-any (iokit-user-client-class "AppleCLCD")
(iokit-user-client-class "AppleCLCD2")))
			(require-all
				(iokit-user-client-class "AppleARMBacklight")
				(require-all (require-not (iokit-property "plc-update"))
(require-not (iokit-property "PreStrobe"))
(require-not (iokit-property "PreStrobeConfigNits"))
(require-not (iokit-property "dcp-power-assertion-for-aot")))
				(require-all (require-not (iokit-property "LogLevel"))
(require-not (iokit-property "CompensationTweak"))
(require-not (iokit-property "brightness-nits"))
(require-not (iokit-property "brightness-nits-cap"))
(require-not (iokit-property "DisplayBrightness"))
(require-not (iokit-property "DisplayBrightnessNitsNVRAM"))
(require-not (iokit-property "DisplayBrightnessSliderPosition")))))))
(deny ipc-posix-sem*
	(require-all (require-not (ipc-posix-name "puiprogresswindow.pba"))
(require-not (ipc-posix-name "backboardd.firstboot_check"))))
(deny ipc-posix-shm*
	(require-not (ipc-posix-name "com.apple.AttentionAwareness")))
(deny ipc-posix-shm-read-data
	(require-all
		(ipc-posix-name "apple.shm.notification_center")
		(entitlement-is-bool-true com.apple.security.on-demand-install-capable)))
(deny job-creation)
(deny mach-lookup
	(xpc-service-name "com.apple.WebKit.")
	(xpc-service-name "com.apple.CoreGraphics.CGPDFService")
	(require-all
		(require-not (global-name "com.apple.locationd.synchronous"))
		(require-all (require-not (global-name "com.apple.cvmsServ"))
(require-not (global-name "com.apple.gpumemd.source")))
		(require-not (global-name "com.apple.locationd.registration"))
		(require-not (global-name "com.apple.pairedsyncd.syncstate"))
		(require-not (global-name "com.apple.locationd.spi"))
		(require-not (global-name "com.apple.nano.nanoregistry.paireddeviceregistry"))
		(require-any
			(require-all
				(global-name "com.apple.internal.pstatemonitor")
				(require-not (xpc-service-name "com.apple.AGXCompilerService"))
				(require-not (xpc-service-name "com.apple.MTLCompilerService"))
				(require-not (extension com.apple.security.exception.mach-lookup.global-name))
				(require-not (extension com.apple.security.exception.mach-lookup.local-name))
				(extension com.apple.sandbox.application-group)
				(global-name "com.apple.appleneuralengine")
				(require-any
					(require-all
						(global-name "com.apple.system.notification_center")
						(entitlement-is-bool-true com.apple.security.on-demand-install-capable)
						(xpc-service-name-regex #".+"))
					(require-all
						(global-name "com.apple.lsd.openurl")
						(global-name "com.apple.tccd")
						(global-name "com.apple.lsd.advertisingidentifiers")
						(xpc-service-name-regex #".+"))))
			(require-all
				(require-not (global-name "com.apple.securityd"))
				(require-not (global-name "com.apple.server.bluetooth.le.pipe.xpc"))
				(require-not (global-name "com.apple.server.bluetooth.le.att.xpc"))
				(require-all (require-not (global-name "com.apple.timesync.manager"))
(require-not (global-name "com.apple.timesync.expositor")))
				(require-not (global-name "com.apple.coremedia.videocodecd.decompressionsession"))
				(require-not (global-name "com.apple.powerlog.plxpclogger.xpc"))
				(require-not (global-name "com.apple.accessories.transport-server"))
				(require-all (require-not (global-name "com.apple.airplay.endpoint.xpc"))
(require-not (global-name "com.apple.mediaexperience.endpoint.xpc")))
				(require-all (require-not (global-name "com.apple.oscard"))
(require-not (global-name "com.apple.hid.Bongo"))
(require-not (global-name "com.apple.systemstatus"))
(require-not (global-name "com.apple.perceptiond.api"))
(require-not (global-name "com.apple.fullkeyboardaccess"))
(require-not (global-name "com.apple.backboard.altsysapp"))
(require-not (global-name "com.apple.libEDR.Notification"))
(require-not (global-name "com.apple.runningboard.AccessibilityUIServer"))
(require-not (global-name "com.apple.GameController.gamecontrollerd.driver"))
(require-not (global-name "com.apple.PerfPowerTelemetryClientRegistrationService"))
(require-not (global-name "com.apple.commandandcontrol"))
(require-not (global-name "com.apple.corercd"))
(require-not (global-name "com.apple.coremedia.virtualframebuffer.xpc"))
(require-not (global-name "com.apple.anomalydetectiond.trigger"))
(require-not (global-name "com.apple.accessibility.AXVoiceOverServer"))
(require-not (global-name "com.apple.accessibility.AccessibilityUIServer.gsEvents")))
				(require-not (global-name "com.apple.VoiceOverTouch"))
				(require-not (global-name "com.apple.lsd.xpc"))
				(require-not (global-name "com.apple.callkit.callcontrollerhost"))
				(require-not (global-name "com.apple.coremedia.videocodecd.decompressionsession.xpc"))
				(require-not (global-name "com.apple.nanoprefsync"))
				(require-all (require-not (global-name "com.apple.appleh13camerad"))
(require-not (global-name "com.apple.appleh16camerad")))
				(require-not (global-name "com.apple.SystemConfiguration.configd"))
				(require-not (global-name "com.apple.audio.SystemSoundServer-iOS"))
				(require-not (global-name "com.apple.iokit.powerdxpc"))
				(require-not (global-name "com.apple.FileCoordination"))
				(require-not (global-name "com.apple.CARenderServer"))
				(require-not (global-name "com.apple.internal.studylogd"))
				(require-not (global-name "com.apple.coremedia.endpointremotecontrolsession.xpc"))
				(require-not (global-name "com.apple.siri.VoiceShortcuts.xpc"))
				(require-not (local-name "com.apple.accessibility.gax.client"))
				(require-not (global-name "com.apple.SBUserNotification"))
				(require-not (global-name "com.apple.sysdiagnose.service.xpc"))
				(require-all (require-not (global-name "com.apple.coremedia.capturesource"))
(require-not (global-name "com.apple.coremedia.capturesession")))
				(require-not (global-name "com.apple.backboard.hid-services.xpc"))
				(require-not (global-name "com.apple.accessories.connection-info-server"))
				(require-not (global-name "com.apple.backlightd"))
				(require-not (global-name "PurpleSystemEventPort"))
				(require-not (global-name "PurpleSystemAppPort"))
				(require-not (global-name "com.apple.coremedia.endpoint.xpc"))
				(require-not (global-name "com.apple.chronoservices"))
				(require-not (global-name "com.apple.assistivetouchd"))
				(require-not (global-name "com.apple.accessibility.AXBackBoardServer"))
				(require-not (global-name "com.apple.accessibility.AXSpringBoardServer"))
				(require-not (global-name "com.apple.server.bluetooth"))
				(require-not (global-name "com.apple.mobile.storage_mounter.xpc"))
				(require-not (global-name "com.apple.iphone.axserver-systemwide"))
				(require-not (global-name "com.apple.backboard.hid.services"))
				(require-not (global-name "com.apple.frontboard.systemappservices"))
				(require-not (global-name "com.apple.awdd"))
				(require-not (global-name "com.apple.VoiceOverTouch.xpc"))
				(require-not (global-name "com.apple.AccessibilityUIServer"))
				(require-not (global-name "com.apple.PowerManagement.control"))
				(require-not (global-name "com.apple.iohideventsystem"))))))
(deny nvram-set
	(require-any (nvram-variable "backlight-nits")
(nvram-variable "backlight-level")
(nvram-variable "40A0DDD2-77F8-4392-B4A3-1E7304206516:backlight-nits")))
(deny syscall-unix
	(c1 3787 741f 9ce0))
(deny sysctl*
	(require-all
		(require-not (sysctl-name "kern.progressoptions"))
		(sysctl-name "kern.wakereason")))
(deny sysctl-read
	(require-all
		(require-all (require-not (sysctl-name "machdep.wake_abstime"))
(require-not (sysctl-name "machdep.wake_conttime"))
(require-not (sysctl-name "kern.exclaves_status"))
(require-not (sysctl-name "security.codesigning.security_boot_mode_complete")))
		(require-not (sysctl-name "kern.progressoptions"))
		(require-not (sysctl-name "kern.wakereason"))))
(deny system-fsctl
	(fsctl-command-regex [UNSUPPORTED](_IO "h" 50)))
(deny system-kas-info)
(deny user-preference-read
	(require-all
		(require-not (preference-domain "com.apple.locationd"))
		(require-all (require-not (preference-domain "com.apple.cinnamon"))
(require-not (preference-domain "com.apple.Magnifier"))
(require-not (preference-domain "com.apple.ComfortSounds"))
(require-not (preference-domain "com.apple.CoreBrightness"))
(require-not (preference-domain "com.apple.GameController.HID.UserPreferences"))
(require-not (preference-domain "com.apple.AppleElements"))
(require-not (preference-domain "com.apple.Accessibility.GuidedAccess"))
(require-not (preference-domain "com.apple.Accessibility.TouchAccommodations")))
		(require-not (preference-domain "com.apple.Metal"))
		(require-not (preference-domain "com.apple.AttentionAwareness"))
		(require-all (require-not (preference-domain "com.apple.Accessibility.Collection"))
(require-not (preference-domain "com.apple.Accessibility.SwitchControl")))
		(require-not (preference-domain "com.apple.UIKit"))
		(require-not (preference-domain "com.apple.AppSupport"))
		(require-not (preference-domain "com.apple.CoreMotion"))
		(require-not (preference-domain "com.apple.iokit.IOMobileGraphicsFamily"))
		(require-not (preference-domain "com.apple.VoiceOverTouch"))
		(require-not (preference-domain "com.apple.powerd.lowpowermode"))
		(require-not (preference-domain "com.apple.logging"))
		(require-not (preference-domain "com.apple.coremedia"))
		(require-not (preference-domain "com.apple.springboard"))
		(require-not (preference-domain "com.apple.GEO"))
		(require-not (preference-domain "com.apple.AssistiveTouch"))
		(require-not (preference-domain "com.apple.mediaaccessibility"))
		(require-not (preference-domain "com.apple.MultitouchSupport"))
		(require-not (preference-domain "com.apple.HearingAids"))
		(require-not (preference-domain "com.apple.icloud.findmydeviced.postwipe"))
		(require-all (require-not (preference-domain "com.apple.iohid"))
(require-not (preference-domain "com.apple.libEDR"))
(require-not (preference-domain "com.apple.mobile.demo"))
(require-not (preference-domain "com.apple.CheckerBoard"))
(require-not (preference-domain "com.apple.hdrprocessing"))
(require-not (preference-domain "com.apple.hid.sessionFilterPlugin.fireflyManager")))
		(require-not (preference-domain "com.apple.SpeakSelection"))
		(require-not (preference-domain "com.apple.demo-settings"))
		(require-not (preference-domain "com.apple.ImageIO"))
		(require-not (preference-domain "com.apple.ZoomTouch"))
		(require-not (preference-domain "com.apple.purplebuddy"))
		(require-not (preference-domain "com.apple.corevideo"))
		(require-not (preference-domain "com.apple.avfoundation"))
		(require-not (preference-domain "com.apple.opengl"))
		(require-not (preference-domain "com.apple.Accessibility"))
		(require-not (preference-domain "com.apple.keyboard.preferences"))
		(require-not (preference-domain "com.apple.carrier"))
		(require-not (preference-domain "com.apple.coreanimation"))
		(require-not (preference-domain "com.apple.NanoRegistry"))
		(require-not (preference-domain "com.apple.iapd"))
		(require-not (preference-domain "com.apple.GameController"))
		(require-not (preference-domain "com.apple.pairedsync"))
		(require-not (preference-domain "com.apple.icloud.findmydeviced.public.notbackedup"))
		(require-not (preference-domain "com.apple.persistentconnection"))
		(require-not (preference-domain "com.apple.backboardd"))
		(preference-domain "com.apple.Accessibility.Magnifier")))
(deny user-preference-write
	(require-all
		(require-not (preference-domain "com.apple.AttentionAwareness"))
		(require-all (require-not (preference-domain "com.apple.Accessibility.Collection"))
(require-not (preference-domain "com.apple.Accessibility.SwitchControl")))
		(require-not (preference-domain "com.apple.VoiceOverTouch"))
		(require-all (require-not (preference-domain "com.apple.cinnamon"))
(require-not (preference-domain "com.apple.Magnifier"))
(require-not (preference-domain "com.apple.ComfortSounds"))
(require-not (preference-domain "com.apple.CoreBrightness"))
(require-not (preference-domain "com.apple.GameController.HID.UserPreferences"))
(require-not (preference-domain "com.apple.AppleElements"))
(require-not (preference-domain "com.apple.Accessibility.GuidedAccess"))
(require-not (preference-domain "com.apple.Accessibility.TouchAccommodations")))
		(require-not (preference-domain "com.apple.springboard"))
		(require-not (preference-domain "com.apple.AssistiveTouch"))
		(require-not (preference-domain "com.apple.mediaaccessibility"))
		(require-not (preference-domain "com.apple.HearingAids"))
		(require-not (preference-domain "com.apple.SpeakSelection"))
		(require-not (preference-domain "com.apple.ZoomTouch"))
		(require-not (preference-domain "com.apple.Accessibility"))
		(require-not (preference-domain "com.apple.persistentconnection"))
		(require-not (preference-domain "com.apple.iapd"))
		(require-not (preference-domain "com.apple.coreanimation"))
		(require-not (preference-domain "com.apple.keyboard.preferences"))
		(preference-domain "com.apple.backboardd")
		(preference-domain "com.apple.Accessibility.Magnifier")))
(deny storage-class-map)
