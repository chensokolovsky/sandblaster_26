(version 1)
(allow default)
(allow (with message version 1 compatibility) (with report) darwin-notification-post)
(allow (with message version 1 compatibility) (with report) dynamic-code-generation)
(allow (with message version 1 compatibility) (with report) file-clone)
(allow (with message version 1 compatibility) (with report) file-link)
(deny file-read*
	(require-not (literal-prefix "${FRONT_USER_HOME}/Library/Preferences/com.apple.da.plist")))
(deny file-write*
	(literal "/private/var/db/spindump/UUIDToBinaryLocations"))
(deny file-write-create
	(require-all
		(vnode-type DIRECTORY)
		(require-not (literal "/private/var/db/spindump"))))
(deny file-write-setugid)
(deny file-write-unlink
	(entitlement-is-present com.apple.private.oop-jit.loader)
	(require-all
		(extension com.apple.sandbox.oopjit)
		(require-not (subpath "/private/var/OOPJit"))))
(allow (with message version 1 compatibility) (with report) fs-quota*)
(allow (with message version 1 compatibility) (with report) fs-quota-get)
(allow (with message version 1 compatibility) (with report) fs-quota-on)
(allow (with message version 1 compatibility) (with report) fs-quota-off)
(allow (with message version 1 compatibility) (with report) fs-quota-set*)
(allow (with message version 1 compatibility) (with report) fs-quota-set-limits)
(allow (with message version 1 compatibility) (with report) fs-quota-set-usage)
(allow (with message version 1 compatibility) (with report) fs-quota-stat)
(allow (with message version 1 compatibility) (with report) fs-quota-sync)
(allow (with message version 1 compatibility) (with report) fs-snapshot-mount)
(deny iokit-open-service
	(entitlement-is-present com.apple.security.exception.iokit-user-client-class))
(deny ipc-posix-shm*
	(ipc-posix-name "apple.shm.notification_center"))
(deny job-creation)
(allow (with message version 1 compatibility) (with report) mach-bootstrap)
(allow (with message version 1 compatibility) (with report) mach-cross-domain-lookup)
(deny mach-lookup
	(require-all
		(require-not (global-name "com.apple.mobile.keybagd.UserManager.xpc"))
		(require-not (global-name "com.apple.mobile.keybagd.xpc"))
		(require-not (global-name "com.apple.osanalytics.osanalyticshelper"))
		(require-not (global-name "com.apple.mobile.usermanagerd.xpc"))
		(require-not (global-name "com.apple.coresymbolicationd"))))
(allow (with message version 1 compatibility) (with report) nvram*)
(allow (with message version 1 compatibility) (with report) nvram-delete)
(allow (with message version 1 compatibility) (with report) nvram-get)
(allow (with message version 1 compatibility) (with report) nvram-set)
(allow (with message version 1 compatibility) (with report) process-info*)
(deny process-info-codesignature
	(target self))
(allow (with message version 1 compatibility) (with report) process-info-listpids)
(deny process-legacy-codesigning-entitlements-der-blob-get
	(target others))
(allow (with message version 1 compatibility) (with report) socket-ioctl)
(allow (with message version 1 compatibility) (with report) socket-option*)
(allow (with message version 1 compatibility) (with report) socket-option-get)
(allow (with message version 1 compatibility) (with report) socket-option-set)
(deny syscall-mig
	(cc 4ad4 5d66 95e7))
(deny sysctl*
	(require-any (sysctl-name "security.mac.sandbox.datacollection.rate")
(sysctl-name "security.mac.sandbox.datacollection.max_proc")))
(deny sysctl-read
	(require-all
		(require-not (sysctl-name "hw.targettype"))
		(require-not (sysctl-name "kern.osreleasetype"))
		(require-all (require-not (sysctl-name "security.mac.sandbox.debug_mode"))
(require-not (sysctl-name "security.mac.sandbox.datacollection.auto_disable")))
		(require-not (sysctl-name "vm.pagesize"))))
(deny system-fcntl
	(ce 04cf 5d5f 5d77))
(deny system-info
	(require-all
		(require-not (info-type "net.link.addr"))
		(require-not (info-type "hw.targettype"))))
(deny system-kas-info)
(deny system-mac-syscall
	(require-all
		(d2 4aeb 5d5a 5d57)
		(require-not (mac-policy-name "Sandbox"))
		(mac-policy-name "AMFI"))
	(require-all
		(require-not (mac-policy-name "Sandbox"))
		(require-any
			(mac-policy-name "AMFI")
			(require-all
				(mac-syscall-number 90)
				(mac-policy-name "AMFI")))))
(deny storage-class-map)
