(version 1)
(deny default)
(allow device-camera
	(extension com.apple.webkit.camera))
(allow device-microphone
	(extension com.apple.webkit.microphone))
(allow darwin-notification-post
	(require-any (notification-name "com.apple.gpumemd.check_in_request")
(notification-name "com.apple.Metal.AGXEnableOSSignposts"))
	(require-any (notification-name "org.WebKit.lowMemory")
(notification-name "org.WebKit.lowMemory.end")
(notification-name "org.WebKit.lowMemory.begin")
(notification-name "com.apple.mobile.keybagd.user_changed")
(notification-name "com.apple.system.logging.prefschanged")
(notification-name "com.apple.WebKit.LibraryPathDiagnostics")
(notification-name "com.apple.CFPreferences._domainsChangedExternally")
(notification-name "AppleDatePreferencesChangedNotification")
(notification-name "AppleNumberPreferencesChangedNotification")
(notification-name "AppleLanguagePreferencesChangedNotification")
(notification-name "AppleMeasurementSystemPreferencesChangedNotification")
(notification-name "AppleTimePreferencesChangedNotification")
(notification-name "AppleTextBehaviorPreferencesChangedNotification")
(notification-name "AppleTemperatureUnitPreferencesChangedNotification")))
(allow file-ioctl
	(literal "/dev/dtracehelper"))
(allow file-issue-extension
	(subpath-prefix "${FRONT_USER_HOME}/XcodeBuiltProducts")
	(require-all
		(extension-class "com.apple.nsurlstorage.extension-cache")
		(require-any (literal "/private/var/root/Library/Caches/")
(literal-prefix "${FRONT_USER_HOME}/Library/Caches/"))
		(extension com.apple.security.exception.files.home-relative-path.read-write))
	(require-all
		(extension com.apple.app-sandbox.read-write)
		(require-any
			(extension-class "com.apple.app-sandbox.read-write")
			(extension-class "com.apple.mediaserverd.read-write")))
	(require-all
		(extension-class "com.apple.app-sandbox.read")
		(require-any
			(extension com.apple.app-sandbox.read-write)
			(extension com.apple.sharing.airdrop.readonly)
			(extension com.apple.app-sandbox.read)))
	(require-all
		(extension-class "com.apple.mediaserverd.read")
		(require-any
			(extension com.apple.app-sandbox.read-write)
			(extension com.apple.sharing.airdrop.readonly)
			(extension com.apple.app-sandbox.read)))
	(require-all
		(extension-class "com.apple.sharing.airdrop.readonly")
		(require-any
			(extension com.apple.app-sandbox.read-write)
			(extension com.apple.sharing.airdrop.readonly)
			(extension com.apple.app-sandbox.read)))
	(require-all
		(extension com.apple.sandbox.executable)
		(require-not (literal))
		(extension-class "com.apple.app-sandbox.read"))
	(require-all
		(require-all (require-not (literal "/System/Library/Caches/apticket.der"))
(require-not (subpath "/System/Library/Caches/com.apple.factorydata"))
(require-not (subpath "/System/Library/Caches/com.apple.kernelcaches")))
		(require-any
			(require-all
				(extension-class "com.apple.mediaserverd.read")
				(require-any
					(subpath "/private/preboot/Cryptexes/OS/System/Library")
					(subpath "/System/Cryptexes/OS/System/Library")
					(subpath "/System/Library")
					(extension com.apple.app-sandbox.read)
					(require-all
						(extension com.apple.assets.read)
						(require-any
							(subpath "/private/var/MobileAsset")
							(subpath-prefix "${HOME}/Library/Assets")))))
			(require-all
				(extension-class "com.apple.app-sandbox.read")
				(require-any
					(subpath "/private/preboot/Cryptexes/OS/System/Library")
					(subpath "/Library/RegionFeatures")
					(subpath "/System/Cryptexes/OS/System/Library")
					(subpath "/System/Library")
					(extension com.apple.app-sandbox.read)
					(extension com.apple.app-sandbox.read-write)
					(extension com.apple.fileprovider.read-write)))
			(require-all
				(extension-class "com.apple.nsurlstorage.extension-cache")
				(extension com.apple.app-sandbox.read-write))
			(require-all
				(extension-class "com.apple.app-sandbox.read-write")
				(require-any
					(extension com.apple.app-sandbox.read-write)
					(extension com.apple.fileprovider.read-write))))))
(allow file-lock)
(allow file-map-executable
	(subpath-prefix "${FRONT_USER_HOME}/XcodeBuiltProducts")
	(subpath "/usr/lib")
	(require-any (subpath "/System/Cryptexes/OS/usr/lib")
(subpath "/System/Cryptexes/OS/System/Library/PrivateFrameworks")
(subpath "/System/Cryptexes/OS/System/Library/Frameworks")
(subpath "/private/preboot/Cryptexes/OS/usr/lib")
(subpath "/private/preboot/Cryptexes/OS/System/Library/Frameworks")
(subpath "/private/preboot/Cryptexes/OS/System/Library/PrivateFrameworks"))
	(subpath "/System/Library")
	(extension com.apple.sandbox.executable)
	(require-all
		(literal)
		(require-not (extension com.apple.sandbox.executable))))
(allow file-read*
	(subpath "/private/var/preferences/Logging")
	(literal "/private/var/Managed Preferences/mobile/.GlobalPreferences.plist")
	(subpath-prefix "${FRONT_USER_HOME}/XcodeBuiltProducts")
	(literal-prefix "${FRONT_USER_HOME}/Library/Preferences/.GlobalPreferences.plist")
	(literal-prefix "${FRONT_USER_HOME}/Library/Preferences/.GlobalPreferences_m.plist")
	(extension com.apple.app-sandbox.read)
	(extension com.apple.app-sandbox.read-write)
	(extension com.apple.sandbox.executable)
	(extension com.apple.sharing.airdrop.readonly)
	(require-all
		(require-all (require-not (literal "/System/Library/Caches/apticket.der"))
(require-not (subpath "/System/Library/Caches/com.apple.factorydata"))
(require-not (subpath "/System/Library/Caches/com.apple.kernelcaches")))
		(require-any
			(subpath-prefix "${HOME}/Library/Fonts")
			(subpath "/private/preboot/Cryptexes/OS/System/Library")
			(require-any (literal-prefix "${HOME}/Library/Preferences/com.apple.Metal.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.coreanimation.plist"))
			(require-any (literal-prefix "${HOME}/Library/Preferences/com.apple.Accessibility.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.mediaaccessibility.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.avfoundation.videoperformancehud.plist"))
			(subpath "/usr/lib")
			(require-any (subpath "/System/Cryptexes/App")
(subpath "/System/Cryptexes/OS")
(subpath "/private/preboot/Cryptexes/OS")
(subpath "/private/preboot/Cryptexes/App"))
			(subpath "/private/var/db/timezone")
			(subpath "/Library/RegionFeatures")
			(subpath "/usr/share")
			(subpath "/System/Library")
			(require-all
				(subpath "/Library/CoreMediaIO/Plug-Ins/DAL")
				(extension com.apple.webkit.camera))
			(require-all
				(require-not (literal-prefix "${HOME}/Library/Preferences/com.apple.mobilemail.plist"))
				(require-any
					(literal "/private/var/preferences/com.apple.networkd.plist")
					(require-any (literal-prefix "${HOME}/Library/Preferences/com.apple.mediaremote.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.avfoundation.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.itunesstored.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.coreaudio.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.coremedia.plist")
(literal-prefix "${HOME}/Library/Preferences/com.apple.corevideo.plist"))
					(subpath "/private/var/containers/Shared/SystemGroup/systemgroup.com.apple.icloud.findmydevice.managed/Library")
					(literal "/dev/urandom")
					(vnode-type BLOCK-DEVICE)
					(vnode-type CHARACTER-DEVICE)
					(literal "/private/etc/passwd")
					(literal "/")
					(literal "/dev/dtracehelper")
					(literal "/private/var/containers/Shared/SystemGroup/systemgroup.com.apple.mobilegestaltcache/Library/Caches/com.apple.MobileGestalt.plist")
					(subpath "/private/var/MobileAsset/AssetsV2/com_apple_MobileAsset_Font7")
					(literal "/dev/random")
					(require-any (subpath "/private/var/containers/Shared/SystemGroup/systemgroup.com.apple.configurationprofiles/Library/ConfigurationProfiles/PublicInfo")
(subpath-prefix "${FRONT_USER_HOME}/Library/ConfigurationProfiles/PublicInfo")
(subpath-prefix "${FRONT_USER_HOME}/Library/UserConfigurationProfiles/PublicInfo"))
					(literal "/private/var/containers/Shared/SystemGroup/systemgroup.com.apple.nsurlstoragedresources/Library/dafsaData.bin"))))))
(allow file-read-data
	(require-all
		(literal)
		(require-not (extension com.apple.sandbox.executable))))
(allow file-read-metadata)
(allow file-read-xattr
	(require-not (xattr "com.apple.security.private.")))
(allow file-test-existence)
(allow file-write*
	(extension com.apple.app-sandbox.read-write)
	(require-all
		(require-not (literal-prefix "${HOME}/Library/Preferences/com.apple.springboard.plist"))
		(literal-prefix "${HOME}/Library/Caches/DateFormats.plist")))
(allow file-write-create
	(require-all
		(require-not (vnode-type SYMLINK))
		(require-all (require-not (literal-prefix "${HOME}/Library/Preferences/com.apple.UIKit.plist"))
(require-not (literal-prefix "${HOME}/Library/Preferences/com.apple.Accessibility.plist")))))
(allow file-write-data
	(require-all
		(require-not (literal "/dev/urandom"))
		(require-not (literal "/dev/random"))
		(literal "/dev/dtracehelper")))
(allow file-write-xattr
	(require-not (xattr "com.apple.security.private.")))
(allow iokit-get-properties
	(iokit-property "IOSurfaceAcceleratorCapabilitiesDict")
	(require-any (iokit-property "product-description")
(iokit-property "device-perf-memory-class")
(iokit-property "compatible-device-fallback")
(iokit-property "graphics-featureset-class")
(iokit-property "graphics-featureset-fallbacks")
(iokit-property "artwork-display-gamut")
(iokit-property "artwork-dynamic-displaymode")
(iokit-property "artwork-device-idiom")
(iokit-property "artwork-device-subtype"))
	(require-any (iokit-property "emu")
(iokit-property "device-id")
(iokit-property "vendor-id")
(iokit-property "udid-version")
(iokit-property "HEVCSupported")
(iokit-property "class-code")
(iokit-property "color-accuracy-index")
(iokit-property "APTDevice")
(iokit-property "AppleJPEGSupportsMissingEOI")
(iokit-property "AAPL,ndrv-dev")
(iokit-property "AAPL,slot-name")
(iokit-property "AAPL,DisplayPipe")
(iokit-property "AAPL,boot-display")
(iokit-property "AAPL,alias-policy")
(iokit-property "AAPL,display-alias")
(iokit-property "AAPL,OpenCLdisabled")
(iokit-property "AAPL,primary-display")
(iokit-property "AAPL,mux-switch-state")
(iokit-property "AAPL,IOGraphics_LER")
(iokit-property "AAPL,IOGraphics_LER_Busy_2")
(iokit-property "AAPL,IOGraphics_LER_RegTag_0")
(iokit-property "AAPL,IOGraphics_LER_RegTag_1")
(iokit-property "IOGVACodec")
(iokit-property "IOGVAScaler")
(iokit-property "IOGVABGRAEnc")
(iokit-property "IOGVAEncoderRestricted")
(iokit-property "IOGLBundleName")
(iokit-property "IOGLESBundleName")
(iokit-property "IOGLESMetalBundleName")
(iokit-property "IOGLESDefaultUseMetal"))
	(iokit-property "AppleJPEGSupportsAppleInterchangeFormats")
	(require-any (iokit-property "ui-pip")
(iokit-property "compatible")
(iokit-property "oled-display"))
	(iokit-property "AVCSupported")
	(iokit-property "product-id")
	(require-any (iokit-property "MetalPluginName")
(iokit-property "MetalPluginClassName")
(iokit-property "BaseAddressAlignmentRequirement"))
	(require-any (iokit-property "canvas-width")
(iokit-property "canvas-height"))
	(iokit-property "als-colorCfg")
	(require-any (iokit-property "dfr")
(iokit-property "hdcp-hoover-protocol")
(iokit-property "DisplayPipeStrideRequirements")
(iokit-property "DisplayPipePlaneBaseAlignment"))
	(iokit-property "soc-generation")
	(iokit-property "chip-id")
	(iokit-property "AppleJPEGSupportsRSTLogging")
	(iokit-property "AppleJPEGNumCores")
	(iokit-property "Protocol Characteristics")
	(iokit-property "iommu-present")
	(iokit-property "software-behavior")
	(iokit-property "IOClassNameOverride")
	(iokit-property "device-colors")
	(iokit-property "display-corner-radius")
	(iokit-property "IOPlatformUUID")
	(iokit-property "artwork-scale-factor")
	(iokit-property "IORegistryEntryPropertyKeys")
	(require-all
		(iokit-user-client-class "IOPlatformExpertDevice")
		(require-any
			(require-any (iokit-property "model")
(iokit-property "model-number"))
			(require-any (iokit-property "platform-name")
(iokit-property "regulatory-model-number"))
			(iokit-property "region-info")))
	(require-all
		(iokit-property "home-button-type")
		(iokit-user-client-class "IOPlatformDevice")))
(allow iokit-open*
	(iokit-connection "IOGPU"))
(allow iokit-open-user-client
	(iokit-user-client-class "IOSurfaceAcceleratorClient")
	(iokit-user-client-class "IOSurfaceRootUserClient")
	(iokit-user-client-class "AGXDeviceUserClient"))
(allow iokit-open-service
	(iokit-user-client-class "AGXAcceleratorG")
	(iokit-user-client-class "AppleM2ScalerCSCDriver")
	(iokit-user-client-class "AppleParavirtGPU")
	(iokit-user-client-class "AppleVideoToolboxParavirtualizationDriver")
	(iokit-user-client-class "IOSurfaceRoot"))
(allow ipc-posix-sem-open
	(ipc-posix-name "purplebuddy.sentinel")
	(ipc-posix-name "containermanagerd.fb_check"))
(allow mach-bootstrap)
(allow mach-derive-port)
(allow mach-kernel-endpoint)
(allow mach-lookup
	(require-all
		(require-not (global-name "com.apple.webkit.camera"))
		(require-any
			(global-name "com.apple.coremedia.compressionsession")
			(global-name "com.apple.coremedia.decompressionsession")
			(global-name "com.apple.audio.AudioQueueServer")
			(global-name "com.apple.coremedia.videoqueue")
			(global-name "com.apple.systemstatus.activityattribution")
			(require-all
				(global-name "com.apple.springboard.statusbarservices")
				(extension com.apple.webkit.microphone))
			(require-all
				(global-name "com.apple.audio.PhaseXPCServer")
				(extension com.apple.webkit.microphone))
			(require-all
				(require-not (global-name "com.apple.iconservices"))
				(require-not (global-name "com.apple.PowerManagement.control"))
				(require-not (global-name "com.apple.frontboard.systemappservices"))
				(require-not (xpc-service-name "com.apple.iconservices"))
				(require-not (global-name "com.apple.audio.AudioComponentRegistrar"))
				(require-not (xpc-service-name "com.apple.audio.toolbox.reporting.service"))
				(require-not (global-name "com.apple.audioanalyticsd"))
				(require-not (global-name "com.apple.coremedia.mediaparserd.utilities"))
				(require-not (global-name "com.apple.fontservicesd"))
				(require-any
					(global-name "com.apple.audio.AudioSession")
					(global-name "com.apple.airplay.apsynccontroller.xpc")
					(xpc-service-name "com.apple.MTLCompilerService")
					(global-name "com.apple.diagnosticd")
					(global-name "com.apple.analyticsd")
					(global-name "com.apple.accessibility.mediaaccessibilityd")
					(global-name "com.apple.coremedia.figcontentkeysession.xpc")
					(require-any (global-name "com.apple.coremedia.cpeprotector.xpc")
(global-name "com.apple.coremedia.routingsessionmanager.xpc"))
					(global-name "com.apple.coremedia.figcontentkeyboss.xpc")
					(global-name "com.apple.coremedia.sts")
					(global-name "com.apple.coremedia.mediaplaybackd.assetimagegenerator.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.cpeprotector.xpc")
					(global-name "com.apple.coremedia.videocodecd.decompressionsession")
					(global-name "com.apple.coremedia.sandboxserver.xpc")
					(require-any (global-name "com.apple.coremedia.audioprocessingtap.xpc")
(global-name "com.apple.coremedia.samplebufferrendersynchronizer.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.samplebufferaudiorenderer.xpc"))
					(global-name "com.apple.coremedia.videocodecd.decompressionsession.xpc")
					(global-name "com.apple.coremedia.videocodecd.compressionsession")
					(global-name "com.apple.coremedia.videocodecd.compressionsession.xpc")
					(global-name "com.apple.mediaremoted.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.player.xpc")
					(require-any (global-name "com.apple.coremedia.routediscoverer.xpc")
(global-name "com.apple.coremedia.volumecontroller.xpc"))
					(require-any (global-name "com.apple.coremedia.samplebufferaudiorenderer.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.audioprocessingtap.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.samplebufferrendersynchronizer.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.figmetriceventtimeline.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.figcontentkeyboss.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.figcontentkeysession.xpc"))
					(global-name "com.apple.coremedia.routingcontext.xpc")
					(global-name "com.apple.coremedia.mediaparserd.formatreader.xpc")
					(require-any (global-name "com.apple.coremedia.figcpecryptor")
(global-name "com.apple.coremedia.mediaplaybackd.figcpecryptor.xpc"))
					(global-name "com.apple.coremedia.formatreader.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.videoqueue")
					(require-any (global-name "com.apple.coremedia.mediaparserd.manifold.xpc")
(global-name "com.apple.coremedia.mediaparserd.fairplaypsshatomparser.xpc"))
					(global-name "com.apple.coremedia.systemcontroller.xpc")
					(global-name "com.apple.audio.AURemoteIOServer")
					(global-name "com.apple.coremedia.admin")
					(global-name "com.apple.coremedia.asset.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.customurlloader.xpc")
					(global-name "com.apple.coremedia.visualcontext.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.visualcontext.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.formatreader.xpc")
					(global-name "com.apple.coremedia.mediaplaybackd.asset.xpc")
					(require-any (global-name "com.apple.coremedia.remaker")
(global-name "com.apple.coremedia.mediaplaybackd.remaker.xpc"))
					(global-name "com.apple.coremedia.assetimagegenerator.xpc")
					(global-name "com.apple.coremedia.player.xpc")
					(require-any (global-name "com.apple.coremedia.cpe.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.cpe.xpc"))
					(require-any (global-name "com.apple.coremedia.capturesource")
(global-name "com.apple.coremedia.capturesession"))
					(global-name "com.apple.coremedia.customurlloader.xpc")
					(require-any (global-name "com.apple.airplay.endpoint.xpc")
(global-name "com.apple.mediaexperience.endpoint.xpc"))
					(global-name "com.apple.coremedia.mediaplaybackd.sandboxserver.xpc")
					(require-any (global-name "com.apple.coremedia.remotequeue")
(global-name "com.apple.coremedia.audiodeviceclock.xpc")
(global-name "com.apple.coremedia.mediaplaybackd.audiodeviceclock.xpc"))
					(global-name "com.apple.CARenderServer")
					(require-all
						(require-not (xpc-service-name-regex #".+"))
						(require-any
							(global-name "com.apple.runningboard")
							(global-name "com.apple.system.notification_center")
							(global-name "com.apple.tccd")
							(global-name "com.apple.logd.events")
							(global-name "com.apple.logd")
							(require-all
								(global-name "com.apple.mobilegestalt.xpc")
								(extension com.apple.webkit.extension.mach)))))))))
(allow mach-task-exception-port-set)
(allow mach-task-special-port*)
(allow mach-task-special-port-get)
(allow mach-task-special-port-set)
(allow network-outbound
	(control-name "com.apple.flow-divert"))
(allow process-codesigning)
(allow process-info-codesignature
	(target self)
	(target others))
(allow process-info-pidinfo)
(allow sandbox-check)
(allow syscall-unix
	(c1 3e0c 6a69 6a68)
	(syscall-number 38))
(allow syscall-mach
	(cb 3e16 6a66 9cde))
(allow syscall-mig
	(cc 3e19 6a64 9cde))
(allow sysctl-read
	(sysctl-name "hw.cpusubfamily")
	(require-any (sysctl-name "kern.bootsessionuuid")
(sysctl-name "hw.optional.arm.FEAT_SME2"))
	(sysctl-name "hw.cpufamily")
	(sysctl-name "hw.product")
	(sysctl-name "machdep.ptrauth_enabled")
	(sysctl-name "vm.malloc_ranges")
	(sysctl-name "kern.bootargs")
	(sysctl-name "vm.footprint_suspend")
	(require-any (sysctl-name "hw.model")
(sysctl-name "hw.logicalcpu_max")
(sysctl-name "hw.physicalcpu_max"))
	(sysctl-name "kern.boottime")
	(sysctl-name "hw.l2cachesize")
	(sysctl-name "kern.osversion")
	(sysctl-name "hw.ncpu")
	(require-any (sysctl-name "hw.activecpu")
(sysctl-name "hw.pagesize_compat")
(sysctl-name "kern.secure_kernel"))
	(sysctl-name "kern.willshutdown")
	(require-any (sysctl-name "hw.perflevel")
(sysctl-name "hw.cachelinesize")
(sysctl-name "kern.hv_vmm_present"))
	(require-any (sysctl-name "hw.machine")
(sysctl-name "kern.osproductversion")
(sysctl-name "kern.osvariant_status"))
	(sysctl-name "hw.memsize")
	(require-all
		(require-not (sysctl-name "sysctl.proc_native"))
		(sysctl-name "hw.tbfrequency_compat")))
(allow system-audit)
(allow system-fcntl
	(ce 3e27 6a4e 9cde))
(allow system-info
	(info-type "net.link.addr"))
(allow system-mac-syscall
	(require-all
		(mac-syscall-number 5)
		(mac-policy-name "Sandbox"))
	(require-all
		(mac-syscall-number 102)
		(mac-policy-name "AMFI"))
	(require-all
		(d2 3e2a 6a4b 9cde)
		(mac-policy-name "Sandbox"))
	(require-all
		(mac-syscall-number 90)
		(mac-policy-name "AMFI")))
(allow system-memorystatus-control)
(allow system-sched
	(entitlement-is-bool-true com.apple.private.kernel.override-cpumon))
(allow user-preference-read
	(preference-domain "com.apple.Metal")
	(preference-domain "com.apple.coremedia")
	(preference-domain "com.apple.coreaudio")
	(preference-domain "com.apple.mediaaccessibility")
	(preference-domain "kCFPreferencesAnyApplication")
	(preference-domain "com.apple.mediaremote")
	(preference-domain "com.apple.itunesstored")
	(preference-domain "com.apple.avfoundation")
	(preference-domain "com.apple.Accessibility")
	(preference-domain "com.apple.avfoundation.videoperformancehud")
	(preference-domain "com.apple.coreanimation")
	(preference-domain "com.apple.corevideo")
	(extension com.apple.security.exception.shared-preference.read-only))
(allow managed-preference-read
	(preference-domain "kCFPreferencesAnyApplication")
	(extension com.apple.security.exception.managed-preference.read-only))
(allow process-exec-update-label)
