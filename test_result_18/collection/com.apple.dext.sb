(version 1)
(deny default)
(allow file-lock)
(allow file-map-executable
	(extension com.apple.sandbox.executable)
	(subpath "/System/Cryptexes")
	(subpath "/private/preboot/Cryptexes")
	(require-any (subpath "/System/DriverKit/usr/lib")
(subpath "/System/DriverKit/System/Library/dyld")
(subpath "/System/DriverKit/System/Library/Frameworks")
(subpath "/System/DriverKit/System/Library/PrivateFrameworks"))
	(require-all
		(subpath "/usr/appleinternal/lib/sanitizers")
		(debug-mode)))
(allow file-read*
	(literal "/dev/null")
	(literal "/private")
	(literal "/dev/urandom")
	(subpath "/private/var/db/timezone")
	(literal "/dev/dtracehelper")
	(require-any (literal "/usr/lib/dyld")
(subpath "/System/DriverKit")
(literal "/System/Library"))
	(require-any (literal "/private/preboot/cryptex1/current/SystemVersion.plist")
(literal "/private/preboot/cryptex1/current/RestoreVersion.plist"))
	(subpath "/System/Library/Frameworks")
	(require-any (literal "/System")
(literal "/private/preboot"))
	(literal "/dev/zero")
	(literal "/private/var/db/DarwinDirectory/local/recordStore.data")
	(literal "/dev/random")
	(literal "/dev/console")
	(literal "/")
	(require-any (subpath "/private/preboot/Cryptexes")
(subpath "/System/Cryptexes"))
	(extension com.apple.sandbox.executable)
	(require-all
		(debug-mode)
		(require-any
			(subpath "/usr/appleinternal/lib/sanitizers")
			(require-all
				(process-attribute is-platform-binary)
				(subpath-prefix "${PROCESS_TEMP_DIR}"))))
	(require-all
		(vnode-type REGULAR-FILE)
		(require-any (literal "/private/var/cores/")
(literal "/private/var/dextcores/"))))
(allow file-read-metadata
	(literal "/private/var")
	(require-any (literal "/usr/standalone/firmware")
(literal "/private/var/hardware")
(literal "/private/var/MobileSoftwareUpdate")
(literal "/private/var/wireless/baseband_data")
(literal "/System/Library/Pearl/ReferenceFrames")
(literal "/System/Library/Caches/com.apple.factorydata"))
	(literal "/private/var/dextcores")
	(literal "/dev")
	(literal "/private/xarts")
	(literal "/tmp")
	(literal "/private/etc/localtime")
	(require-any (literal "/etc")
(literal "/var")))
(allow file-test-existence
	(literal "/dev/null")
	(require-any (literal "/etc")
(literal "/var"))
	(literal "/private")
	(require-any (literal "/usr/lib/dyld")
(subpath "/System/DriverKit")
(literal "/System/Library"))
	(literal "/dev/urandom")
	(literal "/private/var")
	(require-any (literal "/System")
(literal "/private/preboot"))
	(require-any (literal "/usr/standalone/firmware")
(literal "/private/var/hardware")
(literal "/private/var/MobileSoftwareUpdate")
(literal "/private/var/wireless/baseband_data")
(literal "/System/Library/Pearl/ReferenceFrames")
(literal "/System/Library/Caches/com.apple.factorydata"))
	(subpath "/private/var/db/timezone")
	(require-any (subpath "/private/var/dextcores")
(subpath "/private/var/cores"))
	(literal "/dev/random")
	(subpath "/System/Library/Frameworks")
	(literal "/")
	(require-any (subpath "/private/preboot/Cryptexes")
(subpath "/System/Cryptexes"))
	(literal "/dev/zero")
	(literal "/dev")
	(literal "/private/etc/localtime")
	(literal "/private/xarts")
	(literal "/tmp")
	(literal "/dev/console")
	(extension com.apple.sandbox.executable)
	(require-all
		(debug-mode)
		(require-any
			(subpath "/usr/appleinternal/lib/sanitizers")
			(require-all
				(process-attribute is-platform-binary)
				(subpath-prefix "${PROCESS_TEMP_DIR}")))))
(allow file-write*
	(literal "/dev/null")
	(literal "/dev/zero")
	(literal "/dev/console")
	(require-all
		(debug-mode)
		(process-attribute is-platform-binary)
		(subpath-prefix "${PROCESS_TEMP_DIR}"))
	(require-all
		(vnode-type REGULAR-FILE)
		(require-any (literal "/private/var/cores/")
(literal "/private/var/dextcores/"))))
(allow file-write-create
	(require-all
		(vnode-type DIRECTORY)
		(require-any
			(literal "/private/var/cores")
			(literal "/private/var/dextcores"))))
(allow file-write-data
	(literal "/dev/dtracehelper"))
(allow iokit-open-user-client
	(iokit-user-client-class "IOUserServer"))
(allow iokit-open-service
	(iokit-user-client-class "IOPlatformExpert")
	(iokit-user-client-class "IOPlatformExpertDevice"))
(allow mach-derive-port)
(allow mach-kernel-endpoint)
(allow mach-task-exception-port-set)
(allow mach-task-special-port*)
(allow mach-task-special-port-get)
(allow mach-task-special-port-set)
(allow necp-client-open)
(allow process-codesigning)
(allow sandbox-check)
(allow syscall-unix
	(c1 4656 638a 6381)
	(require-all
		(debug-mode)
		(require-not (syscall-number SYS_shm_open))
		(require-not (syscall-number SYS_fstatfs64))
		(require-not (syscall-number SYS_getegid))
		(require-not (syscall-number SYS_objc_bp_assist_cfg_np))
		(require-not (syscall-number SYS_getdirentries64))
		(require-any
			(syscall-number SYS_sigaltstack)
			(syscall-number SYS_setrlimit)
			(syscall-number SYS_sigaction))))
(allow syscall-mach
	(cb 4660 637f 9cde))
(allow syscall-mig)
(allow sysctl-read)
(allow system-fcntl
	(ce 04cf 637d 9cde))
(allow system-mac-syscall
	(require-all
		(mac-policy-name "Sandbox")
		(require-not (mac-syscall-number 4))
		(require-any
			(mac-syscall-number 2)
			(mac-syscall-number 67)))
	(require-all
		(mac-syscall-number 90)
		(mac-policy-name "AMFI")))
(allow system-memorystatus-control)
(allow system-necp-client-action)
(allow system-privilege)
(allow process-exec-update-label)
