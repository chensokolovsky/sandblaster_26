(version 1)
(deny default)
(allow file-lock)
(allow file-test-existence)
(allow iokit-open-user-client
	(iokit-user-client-class "AppleJPEGDriverUserClient"))
(deny (with no-report) iokit-open-service)
(allow(global-name "com.apple.timesync.ptp.manager") mach-bootstrap)
(allow mach-derive-port)
(allow mach-kernel-endpoint)
(allow mach-lookup
	(require-all
		(global-name "com.apple.webkit.camera")
		(require-any
			(require-all
				(extension com.apple.webkit.extension.mach)
				(require-any
					(require-all
						(xpc-service-name "com.apple.audio.toolbox.reporting.service")
						(require-any
							(state-flag)
							(require-all
								(global-name "com.apple.mobilegestalt.xpc")
								(global-name "com.apple.containermanagerd")
								(global-name "com.apple.containermanagerd.system")
								(global-name "com.apple.PowerManagement.control")
								(global-name "com.apple.diagnosticd")
								(global-name "com.apple.SystemConfiguration.configd")
								(global-name "com.apple.fontservicesd")
								(global-name "com.apple.analyticsd")
								(global-name "com.apple.aggregated")
								(global-name "com.apple.iconservices")
								(global-name "com.apple.frontboard.systemappservices")
								(xpc-service-name "com.apple.iconservices")
								(xpc-service-name-regex #".+")
								(require-any
									(require-all
										(global-name "com.apple.system.notification_center")
										(state-flag))
									(require-all
										(global-name "com.apple.runningboard")
										(global-name "com.apple.lsd.mapdb")
										(global-name "com.apple.distributed_notifications@1v3")
										(require-any
											(global-name "com.apple.logd.events")
											(global-name "com.apple.logd")))))
							(require-all
								(extension com.apple.webkit.extension.mach)
								(require-any
									(global-name "com.apple.mobilegestalt.xpc")
									(require-all
										(global-name "com.apple.containermanagerd")
										(global-name "com.apple.containermanagerd.system")
										(global-name "com.apple.PowerManagement.control")
										(global-name "com.apple.diagnosticd")
										(global-name "com.apple.SystemConfiguration.configd")
										(global-name "com.apple.fontservicesd")
										(global-name "com.apple.analyticsd")
										(global-name "com.apple.aggregated")
										(global-name "com.apple.iconservices")
										(global-name "com.apple.frontboard.systemappservices")
										(xpc-service-name "com.apple.iconservices")
										(xpc-service-name-regex #".+")
										(require-any
											(require-all
												(global-name "com.apple.system.notification_center")
												(state-flag))
											(require-all
												(global-name "com.apple.runningboard")
												(global-name "com.apple.lsd.mapdb")
												(global-name "com.apple.distributed_notifications@1v3")
												(require-any
													(global-name "com.apple.logd.events")
													(global-name "com.apple.logd")))))))))
					(require-all
						(global-name "com.apple.mobileassetd.v2")
						(state-flag))))
			(require-all
				(global-name "com.apple.audio.AudioComponentRegistrar")
				(xpc-service-name "com.apple.audio.toolbox.reporting.service")
				(require-any
					(state-flag)
					(require-all
						(global-name "com.apple.mobilegestalt.xpc")
						(global-name "com.apple.containermanagerd")
						(global-name "com.apple.containermanagerd.system")
						(global-name "com.apple.PowerManagement.control")
						(global-name "com.apple.diagnosticd")
						(global-name "com.apple.SystemConfiguration.configd")
						(global-name "com.apple.fontservicesd")
						(global-name "com.apple.analyticsd")
						(global-name "com.apple.aggregated")
						(global-name "com.apple.iconservices")
						(global-name "com.apple.frontboard.systemappservices")
						(xpc-service-name "com.apple.iconservices")
						(xpc-service-name-regex #".+")
						(require-any
							(require-all
								(global-name "com.apple.system.notification_center")
								(state-flag))
							(require-all
								(global-name "com.apple.runningboard")
								(global-name "com.apple.lsd.mapdb")
								(global-name "com.apple.distributed_notifications@1v3")
								(require-any
									(global-name "com.apple.logd.events")
									(global-name "com.apple.logd")))))
					(require-all
						(extension com.apple.webkit.extension.mach)
						(require-any
							(global-name "com.apple.mobilegestalt.xpc")
							(require-all
								(global-name "com.apple.containermanagerd")
								(global-name "com.apple.containermanagerd.system")
								(global-name "com.apple.PowerManagement.control")
								(global-name "com.apple.diagnosticd")
								(global-name "com.apple.SystemConfiguration.configd")
								(global-name "com.apple.fontservicesd")
								(global-name "com.apple.analyticsd")
								(global-name "com.apple.aggregated")
								(global-name "com.apple.iconservices")
								(global-name "com.apple.frontboard.systemappservices")
								(xpc-service-name "com.apple.iconservices")
								(xpc-service-name-regex #".+")
								(require-any
									(require-all
										(global-name "com.apple.system.notification_center")
										(state-flag))
									(require-all
										(global-name "com.apple.runningboard")
										(global-name "com.apple.lsd.mapdb")
										(global-name "com.apple.distributed_notifications@1v3")
										(require-any
											(global-name "com.apple.logd.events")
											(global-name "com.apple.logd"))))))))))))
(allow mach-task-exception-port-set)
(allow mach-task-special-port*)
(allow process-codesigning)
(deny (with no-report) process-info-codesignature)
(allow process-legacy-codesigning-entitlements-blob-get)
(allow process-legacy-codesigning-entitlements-der-blob-get)
(allow process-legacy-codesigning-status-get)
(allow sandbox-check)
(allow syscall-unix
	(c1 41e8 680e 695a)
	(syscall-number SYS_map_with_linking_np)
	(require-all
		(entitlement-is-bool-true com.apple.private.webkit.lockdown-mode)
		(c1 40dd 695c 6968))
	(require-all
		(syscall-number SYS_kdebug_trace_string)
		(require-any
			(state-flag)
			(c1 40e8 9cdf 9cde)))
	(require-all
		(syscall-number SYS_socket)
		(syscall-number SYS_connect)
		(syscall-number SYS_sigreturn)
		(syscall-number 38)
		(require-any
			(c1 40e8 9cdf 9cde)
			(require-all
				(c1 40f2 6964 6963)
				(require-any
					(state-flag UNSUPPORTED)
					(state-flag baseline)))
			(require-all
				(c1 40fb 6966 6967)
				(state-flag)))))
(allow syscall-mach
	(cb 41f2 680c 6951)
	(cb 410e 9cdf 9cde)
	(require-all
		(cb 4107 6952 6953)
		(entitlement-is-bool-true com.apple.private.webkit.lockdown-mode))
	(require-all
		(machtrap-number MSC_task_self_trap)
		(state-flag))
	(require-all
		(machtrap-number MSC_mach_timebase_info_trap)
		(state-flag)))
(allow syscall-mig
	(cc 4111 680a 6940)
	(kernel-mig-routine 242)
	(kernel-mig-routine 268)
	(require-all
		(entitlement-is-bool-true com.apple.private.webkit.lockdown-mode)
		(cc 4117 6948 6968)
		(kernel-mig-routine 135)
		(kernel-mig-routine 134)
		(require-any
			(cc 4128 9cdf 694c)
			(cc 412e 9cdf 9cde)
			(require-all
				(cc 411d 694d 694b)
				(state-flag))))
	(require-all
		(kernel-mig-routine 135)
		(kernel-mig-routine 134)
		(require-any
			(cc 412e 9cdf 9cde)
			(cc 4134 9cdf 694c)
			(require-all
				(cc 411d 694d 6946)
				(state-flag)))))
(allow system-audit)
(allow system-fcntl
	(ce 4145 6808 9cde))
(allow system-memorystatus-control)
(allow process-exec-update-label)
